<h1>Deploy do Backend no Heroku</h1>

<h2>1. O que √© Deploy?</h2>

O verbo **deploy**, em ingl√™s, significa **implantar**.

Em programa√ß√£o, seu sentido est√° intimamente relacionado √† sua tradu√ß√£o literal: fazer um deploy, em termos pr√°ticos, significa colocar na nuvem, ou seja, publicar na Internet alguma aplica√ß√£o que teve seu desenvolvimento conclu√≠do.
Quando um site √© finalizado por uma pessoa desenvolvedora, ele passa pelos √∫ltimos testes e finalmente ele √© hospedado na nuvem atrav√©s do processo chamado deploy.
Do mesmo modo, quando um sistema sofre alguma melhoria ou altera√ß√£o em seu c√≥digo-fonte, implementar essa altera√ß√£o ao sistema que est√° publicado (em Produ√ß√£o), tamb√©m √© chamado de deploy, s√≥ que incremental.

<h2>2. O que veremos por aqui?</h2>

Esse documento √© um passo a passo para voc√™ enviar a sua aplica√ß√£o Spring, gratuitamente para a nuvem. Este processo ir√° gerar um link de acesso a sua aplica√ß√£o, que poder√° ser acessado de qualquer lugar, a partir de qualquer dispositivo com acesso a Internet. 
Para efetuar o Deploy vamos precisar fazer algumas modifica√ß√µes em nosso projeto, que ser√£o detalhadas nos pr√≥ximos t√≥picos.

<h2>üë£ Passo 01 - Criar a Documenta√ß√£o da API</h2>

Para criar a Documenta√ß√£o da API no Swagger, utilize o **Guia de Configura√ß√£o do SPringdoc**.

<h2 id="local">üë£Passo 02 - Testar a API no seu computador</h2>

1. Execute a sua aplica√ß√£o localmente pelo STS

2. Abra o endere√ßo: **http://localhost:8080/** no seu navegador

3. A sua aplica√ß√£o dever√° exibir a tela de **Login (Usu√°rio e Senha)**. Utilize o **usu√°rio: *root@root.com*** e a **Senha: *rootroot***, que foram criados anteriormente.

<div align="center"><img src="https://i.imgur.com/mBRxYd8.png" title="source: imgur.com" width="50%"/></div>

4. Caso a aplica√ß√£o **n√£o** solicite o **Usu√°rio** e a **Senha**, feche todas as janelas abertas do seu Navegador da Internet,  abra novamente e acesse o endere√ßo acima. Se o problema persistir, verifique a sua configura√ß√£o do Swagger.

5. Verifique se ap√≥s o login, o **Swagger** est√° inicializando automaticamente.

6. Caso voc√™ n√£o tenha testado no **Insomnia**, execute os testes e verifique se tudo est√° funcionando. 

7. Em especial, verifique se o M√©todo **logar** est√° devolvendo o **Token**.

8. Antes de continuar a configura√ß√£o do projeto para efetuar o Deploy, n√£o esque√ßa de **parar a execu√ß√£o do Projeto no STS**.

| <img src="https://i.imgur.com/hOgWvSc.png" title="source: imgur.com" width="100px"/> | <p align="justify"> **IMPORTANTE:**  *N√£o altere a senha do usu√°rio root@root.com. Os instrutores da sua turma utilizar√£o este usu√°rio para abrir, testar e corrigir a sua aplica√ß√£o*. </p> |
| ------------------------------------------------------------ | ------------------------------------------------------------ |

| <img src="https://i.imgur.com/hOgWvSc.png" title="source: imgur.com" width="170px"/> | <p align="justify"> **ATEN√á√ÉO:**  *Lembre-se que antes de fazer o Deploy √© fundamental que a API esteja rodando e sem erros*. N√£o fa√ßa os testes via Swagger porqu√™ o Swagger n√£o utiliza todos os recursos da Spring Security, em especial o Token. Utilize o Insomnia para fazer os testes.</p> |
| ------------------------------------------------------------ | ------------------------------------------------------------ |

<h2>üë£ Passo 03 - Criar uma conta gr√°tis no Heroku</h2>

<h3>3.1 O que √© o Heroku?</h3>

O Heroku √© uma plataforma amplamente confi√°vel como uma oferta de  servi√ßo que permite as pessoas Desenvolvedoras realizarem a implanta√ß√£o, escalonamento e gerenciamento de aplicativos na WEB sem complica√ß√µes. Esta  plataforma oferece suporte para uma ampla gama de linguagens de  programa√ß√£o, como Java, Ruby, PHP, Node.js, Python, Scala e Clojure. O Heroku executa aplicativos por meio de cont√™ineres virtuais conhecidos como **Dynos**.

O Heroku √© classificado como um **PaaS** (plataforma e servi√ßo), ou seja, √© um conjunto de servi√ßos para criar e gerenciar aplicativos na nuvem. PaaS fornece os componentes de infraestrutura, que permitem que as pessoas Desenvolvedoras criem, integrem, migrem,  implementem, protejam e gerenciem aplicativos m√≥veis e da web, de forma simples e r√°pida.

>  **Modelos de Servi√ßos na Nuvem:**
>
>  * **Plataforma como um servi√ßo (PaaS):** Um provedor de servi√ßos oferece acesso a um ambiente baseado em cloud no qual os usu√°rios podem desenvolver e fornecer aplicativos. Al√©m do **Heroku**, o **Azure** da Microsoft tamb√©m utiliza este modelo.
>  * **Infraestrutura como um servi√ßo (IaaS):**  Um provedor de servi√ßos fornece aos clientes acesso Pay As You Go (Pague pelo que voc√™ usar), para  armazenamento, rede, servidores e outros recursos de computa√ß√£o na  cloud. O **AWS da Amazon e a Digital Ocean** seguem este modelo.
>  * **Software como um servi√ßo (SaaS):** Um provedor de servi√ßos oferece softwares e aplicativos por meio da  Internet. Os usu√°rios subscrevem ao software e o acessam por meio da web ou de API's do fabricante. o **Google Apps e do Microsoft Office 365** seguem este modelo.

Um grande diferencial do Heroku √© que ele oferece **contas gratu√≠tas**, com limita√ß√µes, que permitem hospedar at√© **05 aplica√ß√µes** com Banco de dados **PostgreSQL**.

**Limita√ß√µes do Plano Gratuito:**

* Se a aplica√ß√£o ficar **30 minutos sem receber nenhuma requisi√ß√£o**, o aplicativo √© finalizado e ser√° reiniciado somente quando receber outra requisi√ß√£o, para economizar os recursos da plataforma.

* Os servidores do Heroku est√£o dispon√≠veis apenas na Europa e no Estados Unidos.

* Os recursos de Mem√≥ria, Disco e Processamento s√£o limitados, logo a aplica√ß√£o e principalmente o Banco de dados n√£o podem ser muito grandes.

* Aceita apenas um Banco de dados por aplica√ß√£o.

Vamos criar a conta no Heroku para fazermos o Deploy:

1) Acesse o endere√ßo: **https://www.heroku.com**

<div align="center"><img  src="https://i.imgur.com/9lFOzru.png" title="source: imgur.com" width="90%"/></div>

2. Crie a sua conta gr√°tis no Heroku clicando no bot√£o **SIGN UP FOR FREE**.

3. Preencha os dados do formul√°rio e clique no bot√£o **CREATE FREE ACCOUNT**.

<div align="center"><img src="https://i.imgur.com/yp46vWx.png" title="source: imgur.com" width="80%"/></div>

4. Ser√° exibida a mensagem abaixo informando que voc√™ receber√° uma mensagem no seu e-mail para ativar a sua conta no Heroku. Acesse o seu e-mail e ative a sua conta.

<div align="center"><img src="https://i.imgur.com/d1YV3RK.png" title="source: imgur.com" width="80%"/></div>

5. O e-mail que voc√™ receber√° ser√° semelhante a imagem abaixo. Clique no link indicado em vermelho para ativar a sua nova conta

<div align="center"><img src="https://i.imgur.com/cgeQPVF.png" title="source: imgur.com" width="85%"/></div>

6. Ser√° aberta a janela abaixo para criar a senha da sua conta. Crie uma senha e clique no bot√£o **SET PASSWORD AND LOGIN**.

<div align="center"><img src="https://i.imgur.com/j3hWcWD.png" title="source: imgur.com" width="80%"/></div>

| <img src="https://i.imgur.com/hOgWvSc.png" title="source: imgur.com" width="120px"/> | <p align="justify"> **ATEN√á√ÉO:**  *A senha deve ter no m√≠nimo 8 caracteres e pelo menos 1 letra mai√∫scula, 1 caracter especial e 1 numero*. </p> |
| ------------------------------------------------------------ | ------------------------------------------------------------ |

7. Ser√° exibida a tela de Boas Vindas. Clique no bot√£o **CLICK HERE TO PROCEED**.

<div align="center"><img src="https://i.imgur.com/0RtgWeI.png?1" title="source: imgur.com" /></div>

8. Na pr√≥xima tela, concorde com os termos de uso da plataforma clicando no bot√£o **Accept**.

<div align="center"><img src="https://i.imgur.com/0pRIHhl.png" title="source: imgur.com" /></div>

9. Voc√™ ser√° redirecionado para o **Dashboard do Heroku**. Agora voc√™ est√° pronto para criar as suas aplica√ß√µes na Nuvem do Heroku.

<div align="center"><img src="https://i.imgur.com/MtxGolw.png" title="source: imgur.com" /></div>

| <img src="https://i.imgur.com/hOgWvSc.png" title="source: imgur.com" width="120px"/> | <p align="justify"> **ATEN√á√ÉO:**  *Conclua todas etapas do processo de cria√ß√£o da conta no Heroku antes de avan√ßar para o pr√≥ximo passo do Deploy*. </p> |
| ------------------------------------------------------------ | ------------------------------------------------------------ |

10. Caso o Heroku exiba a mensagem abaixo, solicitando a ativa√ß√£o do **MFA (Multi-Factor Authentication)**, n√£o habilite esta op√ß√£o. Clique no link **Later**, como mostra a figura abaixo, no item marcado em vermelho.

<div align="center"><img src="https://i.imgur.com/OejMn66.png" title="source: imgur.com" /></div>

| <img src="https://i.imgur.com/hOgWvSc.png" title="source: imgur.com" width="200px"/> | <p align="justify"> **ATEN√á√ÉO:**  *N√£o habilite em sua conta no Heroku a op√ß√£o MFA (Multi-Factor Authentication), ou seja, o login em 2 etapas. Em alguns servidores n√£o √© poss√≠vel efetuar login via Heroku Client com o MFA habilitado*. </p> |
| ------------------------------------------------------------ | ------------------------------------------------------------ |

<h2>üë£ Passo 04 - Criar o arquivo system.properties</h2>

O arquivo **system.properties**, tem o objetivo de informar ao Heroku qual a vers√£o a do Java ele deve utilizar para gerar o seu projeto e criar o arquivo execut√°vel (.jar).

1. Na **raiz do seu projeto**, na pasta **blogpessoal** (como mostra a figura abaixo), crie o arquivo **system.properties**.

<div align="center"><img src="https://i.imgur.com/MSsuQzt.png" title="source: imgur.com" /></div>

| <img src="https://i.imgur.com/vVDBDG0.png" title="source: imgur.com" width="250px"/> | <p align="justify"> **ALERTA DE BSM:** *Mantenha a aten√ß√£o aos detalhes ao criar o arquivo system.properties. Um erro muito comum √© n√£o criar o arquivo na pasta ra√≠z do projeto. Outro erro comum √© digitar o nome do arquivo errado.* </p> |
| ------------------------------------------------------------ | ------------------------------------------------------------ |

2. Na Guia **Package explorer**, clique com o bot√£o direito do mouse sobre a pasta do projeto (indicada em azul) e clique na op√ß√£o **New ü°¢ File**.

<div align="center"><img src="https://i.imgur.com/ykiTjTa.png" title="source: imgur.com" /></div>

3. Em **File name**, digite: **system.properties** e clique no bot√£o **Finish**.

<div align="center"><img width="65%" src="https://i.imgur.com/BRDFhtJ.png" title="source: imgur.com" /></div>

4. No arquivo **system.properties** indique a vers√£o do Java que ser√° utilizada pelo Heroku atrav√©s da linha abaixo:

```properties
java.runtime.version=17
```

| <img src="https://i.imgur.com/hOgWvSc.png" title="source: imgur.com" width="108px"/> | <p align="justify"> **ATEN√á√ÉO:** *A vers√£o do Java informada no arquivo system.properties deve ser a mesma informada no arquivo pom.xml.* </p> |
| ------------------------------------------------------------ | ------------------------------------------------------------ |

| <img src="https://i.imgur.com/RfjtOFi.png" title="source: imgur.com" width="170px"/> | **DICA:** *Durante o Deploy, caso o Heroku n√£o reconhe√ßa a vers√£o correta do Java (Exemplo: informei a vers√£o 11 e o Heroku reconheceu a vers√£o 1.8), apague o arquivo system.properties, recrie o arquivo na ra√≠z do projeto e tente fazer o Deploy novamente.* |
| ------------------------------------------------------------ | :----------------------------------------------------------- |

<br />

<div align="left"><img src="https://i.imgur.com/JACNZiR.png" title="source: imgur.com" width="30px"/> <a href="https://github.com/conteudoGeneration/backend_blog_pessoal/blob/19-blog_pessoal_Deploy_Heroku/blogpessoal/system.properties" target="_blank"><b>C√≥digo fonte: system.properties</b></a>

<h2>üë£ Passo 05 - Adicionar a Depend√™ncia do PostgreSQL no pom.xml</h2>

O Heroku, na sua vers√£o gratuita, utiliza o **PostgreSQL** como **SGBD** (Sistema Gerenciador de Bando de dados). 

No Bloco 02 estamos utilizando o **MySQL** para desenvolver o Blog Pessoal. Ambos s√£o Banco de dados Relacionais e gra√ßas ao **Spring Data JPA**, n√£o ser√° necess√°rio realizar nenhuma altera√ß√£o no c√≥digo da nossa aplica√ß√£o. A √∫nica mudan√ßa necess√°ria, al√©m de adicionar a **Depend√™ncia do PostgreSQL no pom.xml**,  ser√° necess√°rio configurar a conex√£o com o Banco de dados PostgreSQL na nuvem. 

<br />
	
<div align="left"><img src="https://i.imgur.com/b3khcJI.png" title="source: imgur.com" width="25px"/> <a href="https://www.postgresql.org/" target="_blank"><b>Site Oficial: PostgreSQL</b></a></div>

<br />
	
No arquivo, **pom.xml**, vamos adicionar as linhas abaixo, com a depend√™ncia do **PostgreSQL**:

```xml
<dependency>
	<groupId>org.postgresql</groupId>
	<artifactId>postgresql</artifactId>
</dependency> 
```

<h2>üë£ Passo 06 - Configurar o Banco de Dados na Nuvem</h2>

A Configura√ß√£o do Banco de dados Local √© diferente da configura√ß√£o que ser√° utilizada no Heroku. 

No passo anterior, adicionamos a Depend√™ncia do PostgreSQL no arquivo pom.xml, neste passo vamos configurar a aplica√ß√£o para acessar o Banco de dados remoto no Heroku.

Para simplificar o processo, vamos utilizar um recurso do Spring chamado **Profiles** (perfis), que nada mais √© do que criar um modelo de configura√ß√£o para cada situa√ß√£o, ou seja, uma configura√ß√£o para usar localmente (**application-dev.properties**)  e outra para usar na nuvem (**application-prod.properties**). 

O grande benef√≠cio dos Profiles √© simplificar a troca entre a configura√ß√£o Local (**MySQL**) e a configura√ß√£o Remota do Heroku (**PostgreSQL**). 

1) Na Source Folder **src/main/resources**, crie os arquivos **application-dev.properties** (Configura√ß√£o do Banco de dados local) e **application-prod.properties** (Configura√ß√£o do Banco de dados na nuvem).

<div align="center"><img src="https://i.imgur.com/Gj3UbgY.png" title="source: imgur.com" width="45%"/></div>

| <img src="https://i.imgur.com/vVDBDG0.png" title="source: imgur.com" width="250px"/> | <p align="justify"> **ALERTA DE BSM:** *Mantenha a aten√ß√£o aos detalhes ao criar os arquivos application-dev.properties e application-prod.properties. Cuidado para n√£o se equivocar ao nomear os arquivos ou criar em uma pasta diferente.* </p> |
| ------------------------------------------------------------ | ------------------------------------------------------------ |

2. Vamos criar o primeiro arquivo. No lado esquerdo superior, na Guia **Package explorer**, na Source Folder **src/main/resources**, clique com o bot√£o direito do mouse e clique na op√ß√£o **New ü°¢ File**.

3) Em **File name**, digite o nome do primeiro arquivo (**application-dev.properties**) e clique no bot√£o **Finish**.

<div align="center"><img src="https://i.imgur.com/Q1s30nm.png" title="source: imgur.com" width="50%"/></div>

4. Vamos criar o segundo arquivo da mesma forma que criamos o primeiro.

5. Em **File name**, digite o nome do segundo arquivo (**application-prod.properties**) e clique no bot√£o **Finish**.

<div align="center"><img src="https://i.imgur.com/pSiak7m.png" title="source: imgur.com" width="50%"/></div>

Agora vamos configurar os 3 arquivos:

<h3>6.1 Configura√ß√£o do arquivo application.properties</h3>

1. Abra o arquivo **application.properties**, **apague todo o conte√∫do do arquivo** e substitua pelas linhas abaixo  e salve o arquivo. O arquivo application.properties ficar√° com o seguinte conte√∫do:

```properties
spring.profiles.active=prod

springdoc.api-docs.path=/v3/api-docs
springdoc.swagger-ui.path=/swagger-ui.html
springdoc.swagger-ui.operationsSorter=method
springdoc.swagger-ui.disable-swagger-default-url=true
springdoc.swagger-ui.use-root-path=true
springdoc.packagesToScan=com.generation.blogpessoal.controller
```

| <img src="https://i.imgur.com/vVDBDG0.png" title="source: imgur.com" width="150px"/> | <p align="justify"> **ALERTA DE BSM:** *Mantenha a aten√ß√£o aos detalhes ao configurar o arquivo application.properties. Cuidado para n√£o apagar a configura√ß√£o do Swagger (SpringDoc).* </p> |
| ------------------------------------------------------------ | ------------------------------------------------------------ |

<h3>6.2 Configura√ß√£o do arquivo application-dev.properties</h3>

1. Abra o arquivo **application-dev.properties**, insira as linhas abaixo (Configura√ß√£o original do **application.properties**) e salve o arquivo. **N√£o esque√ßa de alterar a senha do usu√°rio root caso a sua senha do MySQL n√£o seja root**.

```properties
spring.jpa.hibernate.ddl-auto=update
spring.jpa.database=mysql
spring.datasource.url=jdbc:mysql://localhost/db_blogpessoal?createDatabaseIfNotExist=true&serverTimezone=America/Sao_Paulo&useSSl=false
spring.datasource.username=root
spring.datasource.password=root

spring.jpa.show-sql=true

spring.jpa.properties.hibernate.dialect = org.hibernate.dialect.MySQL8Dialect

spring.jackson.date-format=yyyy-MM-dd HH:mm:ss
spring.jackson.time-zone=Brazil/East
```

<h3>6.3 Configura√ß√£o do arquivo application-prod.properties</h3>

1. No arquivo, **application-prod.properties**,  insira as linhas abaixo e salve o arquivo:

```properties
spring.jpa.generate-ddl=true
spring.datasource.url=${JDBC_DATASOURCE_URL}
spring.jpa.show-sql=true

spring.jackson.date-format=yyyy-MM-dd HH:mm:ss
spring.jackson.time-zone=Brazil/East
```

| <img src="https://i.imgur.com/hOgWvSc.png" title="source: imgur.com" width="120px"/> | <div align="left"> **ATEN√á√ÉO:** *Depois de finalizar as configura√ß√µes dos 3 arquivos, recomendamos executar o comando Update Project para atualizar as configura√ß√µes do projeto.* </div> |
| ------------------------------------------------------------ | ------------------------------------------------------------ |

<h3>6.4 Alternando entre os perfis no arquivo application.properties</h3>

1. Para alternar entre as configura√ß√µes Local e Remota, abra o arquivo **application.properties** e utilize uma das 2 op√ß√µes abaixo:

<b><code>spring.profiles.active=dev</code> </b> ü°¢ O Spring executar√° a aplica√ß√£o com a configura√ß√£o do Banco de dados local (MySQL)

<b><code>spring.profiles.active=prod</code> </b> ü°¢ O Spring executar√° a aplica√ß√£o com a configura√ß√£o do Banco de dados na nuvem (Heroku)

Para o Deploy, devemos deixar a linha **spring.profiles.active** configurada com a op√ß√£o **prod**.

| <img src="https://i.imgur.com/vVDBDG0.png" title="source: imgur.com" width="250px"/> | <p align="justify"> **ALERTA DE BSM:** *Mantenha a aten√ß√£o aos detalhes ao criar os perfis do Banco de Dados. Um erro muito comum √© tentar executar o seu projeto no STS com o Perfil prod habilitado no arquivo application.properties. Com o perfil prod habilitado, o projeto n√£o ser√° inicializado.* </p> |
| ------------------------------------------------------------ | ------------------------------------------------------------ |

| <img src="https://i.imgur.com/hOgWvSc.png" title="source: imgur.com" width="150px"/> | <div align="left"> **ATEN√á√ÉO:** *Caso o projeto seja inicializado normalmente com o perfil prod, verifique se os nomes dos arquivos de perfil e as configura√ß√µes est√£o corretas. Se peristir, execute o comando Update Project.* </div> |
| ------------------------------------------------------------ | ------------------------------------------------------------ |
	
<div align="left"><img src="https://i.imgur.com/JACNZiR.png" title="source: imgur.com" width="30px"/> <a href="https://github.com/conteudoGeneration/backend_blog_pessoal/tree/19-blog_pessoal_Deploy_Heroku" target="_blank"><b>C√≥digo fonte: Projeto finalizado</b></a>

<h2>üë£ Passo 07 - Atualizar o reposit√≥rio do projeto no Github</h2>

1. Envie as atualiza√ß√µes do seu projeto para o reposit√≥rio do  Github, atrav√©s do **Git Bash**, utilizando os comandos abaixo:

   ```bash
    git add .
    
    git commit -m ‚ÄúDeploy do Projeto Blog Pessoal‚Äù
    
    git push origin main
   ```
   
| <img src="https://i.imgur.com/hOgWvSc.png" title="source: imgur.com" width="400px"/> | <div align="left"> **ATEN√á√ÉO:** *Para efetuar o Deploy, o projeto Spring OBRIGATORIAMENTE precisa estar em um Reposit√≥rio EXCLUSIVO e n√£o pode estar DENTRO DE UMA PASTA, ou seja, ao abrir o reposit√≥rio do projeto no Github, o conte√∫do exibido ser√° semelhante ao da imagem abaixo. Se estiver diferente da imagem abaixo ser√° necess√°rio refazer o Reposit√≥rio do Github.* </div> |
| ------------------------------------------------------------ | ------------------------------------------------------------ |

<div align="center"><img src="https://i.imgur.com/hIINFfv.png" title="source: imgur.com" /></div>

<h2>üë£ Passo 08 - Criar um novo projeto no Heroku</h2>

1) Acesse o endere√ßo do Heroku: **https://www.heroku.com**

<div align="center"><img  src="https://i.imgur.com/9lFOzru.png" title="source: imgur.com" width="90%"/></div>

2. Fa√ßa o login no Heroku, caso a p√°gina Personal do Heroku n√£o seja aberta automaticamente, como mostra a figura abaixo:

<div align="center"><img  src="https://i.imgur.com/RDjVYNz.png?1" title="source: imgur.com" width="90%"/></div>

3. Clique no bot√£o **New** para criar uma nova aplica√ß√£o.

<div align="center"><img  src="https://i.imgur.com/vLffwkC.png?1" title="source: imgur.com" width="90%"/></div>

4. Clique na op√ß√£o **Create new app**.

<div align="center"><img  src="https://i.imgur.com/ELWq9f8.png" title="source: imgur.com" /></div>

5. D√™ um nome para a aplica√ß√£o e clique no bot√£o **Create app**.

<div align="center"><img  src="https://i.imgur.com/YbLn3h0.png" title="source: imgur.com" /></div>

Caso o nome escolhido esteja dispon√≠vel, ser√° exibida a mensagem **is available** na cor verde.

   | <img src="https://i.imgur.com/hOgWvSc.png" title="source: imgur.com" width="220px"/> | <p align="justify"> **ATEN√á√ÉO:** O NOME DO PROJETO N√ÉO PODE CONTER LETRAS MAIUSCULAS, NUMEROS OU CARACTERES ESPECIAIS. AL√âM DISSO ELE PRECISA SER √öNICO DENTRO DA PLATAFORMA HEROKU. </p> |
   | ------------------------------------------------------------ | ------------------------------------------------------------ |

Caso o nome escolhido n√£o esteja dispon√≠vel, ser√° exibida a mensagem **is not available** na cor vermelha

<div align="center"><img src="https://i.imgur.com/tYvr3nr.png" title="source: imgur.com"/></div>

<h2>üë£ Passo 09 - Adicionar o Banco de dados no Heroku</h2>

1. Para adicionar um **Banco de Dados PostgreSQL** no seu projeto, clique na guia **Resources** na pr√≥xima tela que ser√° aberta ap√≥s a cria√ß√£o da aplica√ß√£o.

<div align="center"><img src="https://i.imgur.com/MnxWSKL.png?1" title="source: imgur.com" /></div>

2. No item **Add-ons**, digite na caixa de pesquisa **"postgres"** e selecione a op√ß√£o **Heroku Postgres**.

<div align="center"><img src="https://i.imgur.com/2ELLzc3.png?1" title="source: imgur.com"/></div>

3. Na pr√≥xima tela, certifique-se de que o **Plan name** seja o **Hobby Dev - Free**. Clique no bot√£o **Submit Order Form** para concluir.

<div align="center"><img src="https://i.imgur.com/Xjcgde1.png" title="source: imgur.com" width="60%"/></div>

| <img src="https://i.imgur.com/hOgWvSc.png" title="source: imgur.com" width="130px"/> | <p align="justify"> **ATEN√á√ÉO:** *Caso seja selecionado um plano diferente, o Heroku exigir√° o Cart√£o de Cr√©dito para emitir a fatura do servi√ßo. </p> |
| ------------------------------------------------------------ | ------------------------------------------------------------ |

4. Observe na pr√≥xima tela que o custo do Plano √© gratuito.

<div align="center"><img src="https://i.imgur.com/Y3t9WL5.png?1" title="source: imgur.com" /></div>

| <img src="https://i.imgur.com/hOgWvSc.png" title="source: imgur.com" width="150px"/> | <p align="justify"> **ATEN√á√ÉO:** *O processo do Deploy enviar√° apenas a sua aplica√ß√£o para a nuvem, logo o Banco de dados que ser√° criado nesta etapa estar√° vazio. </p> |
| ------------------------------------------------------------ | ------------------------------------------------------------ |

<h2>üë£Passo 10 - Configurar o fuso hor√°rio</h2>

1. Para configurar o **Fuso Hor√°rio** no seu projeto, clique na guia **Settings**.

<div align="center"><img src="https://i.imgur.com/1NB8i9Y.png?1" title="source: imgur.com" /></div>

2. No item **Config vars**, clique no bot√£o **Reveal Config Vars**.

<div align="center"><img src="https://i.imgur.com/Z8tUwrL.png" title="source: imgur.com" /></div>

3. Adicione a vari√°vel **TZ**, com o valor **America/Sao_Paulo** (como mostra a figura abaixo) e clique no bot√£o **Add** para concluir.

<div align="center"><img src="https://i.imgur.com/w6qlcjg.png" title="source: imgur.com" /></div>

<h2>üë£ Passo 11 - Deploy</h2>

1. Para configurar o **Deploy** do seu projeto, clique na guia **Deploy**.

<div align="center"><img src="https://i.imgur.com/WSNVenp.png?1" title="source: imgur.com" /></div>

2. Na sequ√™ncia, clique no √≠cone do **Github**

<div align="center"><img src="https://i.imgur.com/dYrPaJw.png?1" title="source: imgur.com" /></div>

3. No item **App connected to Github**, clique no bot√£o **Connect to Github**

<div align="center"><img src="https://i.imgur.com/lL0TdnQ.png?1" title="source: imgur.com" /></div>

4. Na pr√≥xima tela, clique no bot√£o **Authorize Heroku**, para liberar o acesso do Heroku na sua conta do Github.

<div align="center"><img src="https://i.imgur.com/txzWowQ.png" title="source: imgur.com" width="60%"/></div>

5. Fa√ßa o login na sua conta do Github, para concluir

<div align="center"><img src="https://i.imgur.com/Vg33lXN.png" title="source: imgur.com" width="60%"/></div>

6. Em seguida, vamos procurar o **Reposit√≥rio do Projeto Blog Pessoal**

7. No item **Connect to Github**, na caixa de pesquisa **repo-name**, digite o **Nome do Reposit√≥rio do Projeto Blog Pessoal** e clique no bot√£o **Search**.

<div align="center"><img src="https://i.imgur.com/w0rh7ng.png?1" title="source: imgur.com" /></div>

8. Ser√° exibido o reposit√≥rio. Clique no bot√£o **Connect** ao lado do Reposit√≥rio do Projeto Blog Pessoal.

<div align="center"><img src="https://i.imgur.com/bEyLrDy.png" title="source: imgur.com" /></div>

9. Observe que o Heroku indicar√° que a aplica√ß√£o est√° **Conectada com o Reposit√≥rio**.

<div align="center"><img src="https://i.imgur.com/LDDqEY4.png" title="source: imgur.com" /></div>

10. No item **Automatic deploys**, no item **Choose a branch to deploy**, selecione a **Branch** que ser√° usada para fazer o Deploy (main). Na sequ√™ncia, clique no bot√£o **Enable Automatic Deploys**, para automatizar o processo, ou seja, toda vez que voc√™ fizer um **push no Reposit√≥rio no Github**, o Heroku tentar√° fazer o Deploy automaticamente.

<div align="center"><img src="https://i.imgur.com/tErTzAl.png?1" title="source: imgur.com" /></div>

| <img src="https://i.imgur.com/hOgWvSc.png" title="source: imgur.com" width="150px"/> | <p align="justify"> **ATEN√á√ÉO:** *O Deploy autom√°tico ser√° conclu√≠do, APENAS E SOMENTE SE o c√≥digo que foi enviado para o Github esteja sem erros e com o perfil PROD habilitado. </p> |
| ------------------------------------------------------------ | ------------------------------------------------------------ |

11. No item **Manual deploy**, clique no bot√£o **Deploy branch**.

<div align="center"><img src="https://i.imgur.com/BdZnZnQ.png?1" title="source: imgur.com" /></div>

12. Logo abaixo, ser√° exibida a janela do **Console do Heroku**. Acompanhe o processo do Deploy e aguarde a conclus√£o

<div align="center"><img src="https://i.imgur.com/UWlFFXa.png" title="source: imgur.com" /></div>

13. Se o Deploy foi bem sucedido, ser√° exibida a mensagem **Deploy to Heroku - Your app was succesfully deployed**.

<div align="center"><img src="https://i.imgur.com/TCCFf2j.png" title="source: imgur.com" /></div>

14. Clique no bot√£o **View** para abrir a aplica√ß√£o.

| <img src="https://i.imgur.com/hOgWvSc.png" title="source: imgur.com" width="150px"/> | <p align="justify"> **ATEN√á√ÉO:** *Caso aconte√ßa algun erro no processo do Deploy ser√° exibida a mensagem: Build failed!.  Verifique o seu c√≥digo e tente novamente.</p> |
| ------------------------------------------------------------ | ------------------------------------------------------------ |

<h2>üë£ Passo 12 - Abrir o Deploy no Navegador</h2>

1. Ao abrir a sua aplica√ß√£o no Navegador, ser√° exibida a tela de login abaixo. Como o Banco de dados criado no Heroku est√° vazio, precisamos criar uma conta de usu√°rio e efetuar o login com esta conta antes de exibir a sua documenta√ß√£o no Swagger. 

<div align="center"><img src="https://i.imgur.com/cQcrj4p.png" title="source: imgur.com" width="50%"/></div>

2. Abra o **Insomnia** e acesse a Workspace **Blog Pessoal**.

3. Crie uma pasta chamada **Blog Pessoal** e arraste as 3 pastas (Postagem, Tema e Usuario) para dentro dela.

4. Duplique a pasta **Blog Pessoal**.

5. Na pr√≥xima janela, defina o nome da nova pasta como **Blog Pessoal - Heroku**.

<div align="center"><img src="https://i.imgur.com/ast14mj.png" title="source: imgur.com" /></div>

6. Abra a requisi√ß√£o **Cadastrar Usu√°rio** na pasta **Blog Pessoal - Heroku**.

7. Altere o caminho atual: **http://localhost:8080/usuarios/cadastrar** 

<div align="center"><img src="https://i.imgur.com/0zGznXO.png" title="source: imgur.com" /></div>

8. Para o endere√ßo do Heroku: https://meuprojeto.herokuapp.com/usuarios/cadastrar (No exemplo acima: https://bpspring.herokuapp.com/usuarios/cadastrar)

<div align="center"><img src="https://i.imgur.com/h4yIVZB.png" title="source: imgur.com" /></div>

9. Ap√≥s efetuar as altera√ß√µes, crie o usu√°rio **root@root.com** com os dados da imagem abaixo:

<div align="center"><img src="https://i.imgur.com/J4mCZqH.png" title="source: imgur.com" /></div>

| <img src="https://i.imgur.com/vVDBDG0.png" title="source: imgur.com" width="150px"/> | <p align="justify"> **ALERTA DE BSM:** *Mantenha a aten√ß√£o aos detalhes. Crie o usu√°rio root exatamente como mostra a figura acima. Ser√° atrav√©s deste usu√°rio que os Instrutores da sua turma ir√£o corrigir o seu projeto*. </p> |
| ------------------------------------------------------------ | ------------------------------------------------------------ |
	
10. Volte para o Navegador da Internet e efetue o login com o usu√°rio **root@root.com**.

<div align="center"><img src="https://i.imgur.com/5Imr1H5.png" title="source: imgur.com" /></div>

11. A Documenta√ß√£o no Swagger ser√° exibida como a p√°gina inicial.

<div align="center"><img src="https://i.imgur.com/8ZVSPpM.png" title="source: imgur.com" width="90%"/></div>

12. Outra forma de abrir a aplica√ß√£o √© digitando o endere√ßo: **[https://nomedoprojeto.herokuapp.com](https://nomedoprojeto.herokuapp.com/)** no navegador. (No exemplo acima: https://bpspring.herokuapp.com)

<h2>üë£ Passo 13 - Testar o Deploy no Insomnia</h2>

1. Volte para o **Insomnia** 

2. Atualize o endere√ßo de todas requisi√ß√µes da pasta **Blog Pessoal - Heroku**, assim como foi feito na requisi√ß√£o **Cadastrar Usu√°rio**

3. Execute a requisi√ß√£o **Login** para acessar a API

4. Teste todas requisi√ß√µes seguindo as orienta√ß√µes do **Checklist do Projeto Blog Pessoal**.

| <img src="https://i.imgur.com/vVDBDG0.png" title="source: imgur.com" width="200px"/> | <p align="justify"> **ALERTA DE BSM:** *Mantenha a aten√ß√£o aos detalhes e a persist√™ncia. Insira dados na API atrav√©s do Insomnia em todos os recursos (Postagem, Tema e Usuario). No recurso Postagem, n√£o esque√ßa de testar o Relacionamento entre as Classes*. </p> |
| ------------------------------------------------------------ | ------------------------------------------------------------ |

<h2 id="update">3. Como atualizar o Deploy no Heroku? </h2>

| <img src="https://i.imgur.com/vVDBDG0.png" title="source: imgur.com" width="150px"/> | <p align="justify"> **ALERTA DE BSM:** *Mantenha a aten√ß√£o aos detalhes. Este item voc√™ utilizar√° apenas se voc√™ precisar alterar alguma coisa no seu projeto Spring e atualizar  a aplica√ß√£o na nuvem*. </p> |
| ------------------------------------------------------------ | ------------------------------------------------------------ |

1. Para fazer altera√ß√µes no c√≥digo do projeto e executar localmente, volte para o **STS** e altere a primeira linha do arquivo, **application.properties** conforme o c√≥digo abaixo:

```properties
spring.profiles.active=dev
```

2. Fa√ßa as altera√ß√µes necess√°rias no c√≥digo do seu projeto, execute localmente e verifique se est√° tudo funcionando **sem erros**.

3. Antes de refazer o Deploy, altere novamente a primeira linha do arquivo, **application.properties** conforme o c√≥digo abaixo:

```properties
spring.profiles.active=prod
```

4.  Envie as atualiza√ß√µes do seu projeto para o reposit√≥rio do  Github, atrav√©s do **Git Bash**, utilizando os comandos abaixo: 

```bash
git add .
git commit -m ‚ÄúAtualiza√ß√£o do Deploy - Blog Pessoal‚Äù
git push origin main
```

5. Ao finalizar o **git push**, o Heroku come√ßar√° a refazer o Deploy. Acompanhe o processo pelo site do Heroku. 

<div align="center"><img src="https://i.imgur.com/OV0xFEY.png" title="source: imgur.com" /></div>

6. Se o Deploy foi bem sucedido, ser√° exibida a mensagem **BUILD SUCCEEDED**.

<div align="left"><img src="https://i.imgur.com/v3HLIWW.png" title="source: imgur.com" /></div>

7. Verifique se a Aplica√ß√£o abre no Navegador e fa√ßa os testes no Insomnia.

<br /><br />
	
<div align="left"><a href="README.md"><img src="https://i.imgur.com/XMgF3gl.png" title="source: imgur.com" width="3%"/>Voltar</a></div>

